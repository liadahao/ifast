<!DOCTYPE html>
<html>
<head lang="en" xmlns:th="http://www.thymeleaf.org">
    <meta charset="UTF-8">
    <title>Article</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport"
          content="width=device-width, initial-scale=1">
    <meta name="format-detection" content="telephone=no">
    <meta name="renderer" content="webkit">
    <meta http-equiv="Cache-Control" content="no-siteapp"/>
    <link th:href="@{/css/amazeui.min.css}" rel="stylesheet" type="text/css"/>
    <link th:href="@{/css/page.css}" rel="stylesheet" type="text/css"/>
    <link th:href="@{/css/front/articleDetail.css}" rel="stylesheet" type="text/css"/>
</head>
<body>
<div class="article">
    <div class="am-g">
        <input id="id" type="hidden" th:value="${article.id}">
        <div th:style="'background-image:url(' + @{(${article.thumbnail}=='' ? '' : ${article.thumbnail})} + ')'"
             class="article-haed">
            <div class="am-topbar">
                <span><a href="/"><img class="nav-logo" src="/img/logo.png"/></a></span>
                <span><img class="nav" src="/img/nav.png" data-am-offcanvas="{target: '#doc-oc-demo3'}"></span>
            </div>
            <div class="head-body">
                <h1 th:text="${article.title}" class="am-text-center"></h1>
                <h2 th:text="${article.author +'&nbsp;&nbsp;&nbsp;'+ article.createTime}" class="am-text-center"></h2>
                <h3 th:text="'Posted by&nbsp;' + ${article.createUserName}" class="am-text-center"></h3>
            </div>
        </div>
        <div class="main-body">
            <div class="tag-list">
                <div class="tag" th:each="tag :${tags}" th:if="${tag!=null}" th:text="${tag['name']}">
                </div>
            </div>
            <div th:utext="${article.content}" class="article-content">

            </div>
            <div class="from-url">
                <a th:if="${article['linkTo'] ne ''}" th:text="from+' ' + ${article['linkTo']}"
                   th:href="${article['linkTo']}">
                </a>
            </div>
            <div class="article-info am-g">
                <div class="share-icon am-u-sm-6">
                    <a th:if="${article['social']}" th:each="social,socialStat:${article['social']}" href="#"
                       th:attr="class=|am-icon-btn am-icon-${#strings.toLowerCase(social.type)}|"
                       th:href="${social['url']}"></a>
                </div>
                <div class="custom-icon am-u-md-2">
                    <div class="am-u-md-2">
                        <img src="/img/0503surrpise.png" alt=""
                             width="30" height="30">
                    </div>
                    <div class="am-text-middle am-u-md-4">
                        <p class="am-text-center">SURPRISE</p>
                        <p th:text="${article['goodCount']}" class="am-text-center">0</p>
                    </div>
                    <div class="am-u-md-2">
                        <img src="/img/0503hard.png" alt=""
                             width="30" height="30">
                    </div>
                    <div class="am-text-middle am-u-md-4">
                        <p class="am-text-center">TRY HARD</p>
                        <p th:text="${article['keepTryingCount']}" class="am-text-center">0</p>
                    </div>
                </div>
            </div>
            <div class="article-like">
                <div class="am-article-divider"></div>
                <h3 class="am-text-center">Some articles you might like</h3>
                <ul id="article-like-list" class="am-avg-sm-3">
                </ul>
            </div>
        </div>
    </div>
</div>


<!-- 侧边栏内容 -->
<div th:include="nav :: nav-side"></div>
</body>
<script type="text/javascript" th:src="@{/js/jquery.min.js}"></script>
<script type="text/javascript" th:src="@{/js/amazeui.min.js}"></script>
<script>
    $(function () {
        var sideId = '#doc-oc-demo3';
        var $myOc = $(sideId);
        $('.side-close').on('click', function () {
            $myOc.offCanvas($(this).data('rel'));
        });
        var id = $("#id").val();
        $.ajax({
            type: "GET",
            url: "/article/" + id + "/maylike",
            data: {"pageNumber": "1", "pageSize": "3"},
            async: false,
            error: function (request) {
            },
            success: function (data) {
                handleData(data);
            }
        });
        $('#article-like-list li').click(function () {
            window.location.href = "/article/" + $(this).attr("id");
        })
    });

    function handleData(data) {
        var row = data.data.records;
        var list = $("#article-like-list");
        for (var j = 0, len = row.length; j < len; j++) {
            var obj = row[j];
            html = '<li id="' + obj.id + '">\n' +
                '            <img src="' + obj.thumbnail + '" style="width: 100%;height: 200px"/>\n' +
                '            <div class="text">\n' +
                '                <h1 class="box-title">\n' +
                obj.title +
                '                </h1>\n' +
                '                <div class="box-conetnt">\n' +
                obj.summary +
                '                </div><div class="tag-list">\n' +
                '' +
                '                </div><div class="author">\n' +
                obj.author +
                '                </div><div class="create-time">' + obj.createTime + '</div></div>\n' +
                '        </li>'
            list.append(html);
            var tagList = $("#" + obj.id + " .tag-list");
            for (var i = 0; i < obj.tag.length; i++) {
                var tagHtml = '<div class="tag">' + obj.tag[i] + '</div>';
                tagList.append(tagHtml);
            }
        }
    }
</script>
</html>
